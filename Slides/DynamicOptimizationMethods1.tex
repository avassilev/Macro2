% !TeX spellcheck = bg_BG
\documentclass[leqno]{beamer}
\mode<presentation>
\usetheme{Warsaw}
\useoutertheme{split}
\usepackage{amsmath}
\usepackage{amstext}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{amsbsy}
%\usepackage[bookmarks=false]{hyperref}
%\usepackage[round]{natbib}
%\usepackage{rotating}
%\usepackage{pstricks}
\usepackage[T2A]{fontenc}
\usepackage[cp1251]{inputenc}
\usepackage[bulgarian]{babel}
\usepackage[]{graphicx}
\usepackage{xcolor}
\newtheorem{thm}{Теорема}
\newtheorem{prop}{Твърдение}
\newtheorem{lem}{Лема}
\newtheorem{cor}{Следствие}
% \theoremstyle{remark} % наименованието е в италик (а не в курсив), тялото е стандартно (а не в италик)
\theoremstyle{definition} % наименованието е в курсив, тялото е стандартно (а не в италик)
\newtheorem{remark}{Забележка}
\newtheorem{defin}{Дефиниция}
\newcommand{\beq}{\begin{equation}}
\newcommand{\eeq}{\end{equation}}
\newcommand{\bs}{\boldsymbol}
\DeclareMathOperator*{\argmax}{argmax}
\DeclareMathOperator*{\argmin}{argmin}
\DeclareMathOperator*{\sign}{sign}
\DeclareMathOperator*{\meas}{meas}
\DeclareMathOperator*{\essinf}{essinf}
\DeclareMathOperator*{\Ran}{Ran} \DeclareMathOperator*{\intr}{int}
\DeclareMathOperator*{\grad}{grad}
\DeclareMathOperator*{\dist}{dist}
\title[]{Детерминистични динамични оптимизационни задачи във вариационна формулировка}
\author[]{Андрей Василев \\ \href{mailto:avassilev@fmi.uni-sofia.bg}{avassilev@fmi.uni-sofia.bg} }
\date{}


\begin{document}\newcounter{slidenum}

\begin{frame}
\begin{titlepage}

\end{titlepage}
\end{frame}

\begin{frame}
	\frametitle{Основни въпроси}
	\begin{itemize}
		\item Постановка на задачата 
		\item Принцип за оптималност и уравнение на Белман 
		\item Уравнения на Ойлер
	\end{itemize}
\end{frame}

%\section{Постановка}
\begin{frame}[fragile]
	\frametitle{Постановка}
	\framesubtitle{Общи положения}
	\begin{itemize}\itemsep1em
		\item Оптимизационна задача със специална структура на целевата функция:
		\begin{itemize}\itemsep1em
			\item адитивност
			\item дисконтиране
			\item безкраен хоризонт
		\end{itemize}
		\item Ограничения, които свързват допустимите стойности между различните периоди
		\item Зададено начално условие
	\end{itemize}
\end{frame}




\begin{frame}[fragile]
	\frametitle{Постановка}
	\framesubtitle{Формулировка}
Разглеждаме задачата
\begin{equation}\label{eq:SP}\tag{SP}
\begin{array}{l}
\sup_{ \{x_{t+1}\}_{t=0}^\infty }
\sum_{t=0}^{\infty}\beta^t F(x_t,x_{t+1}) \\ 
{}\\
\text{s.t. } x_{t+1}\in \Gamma (x_t),~t=0,1,2,\ldots, \\ {}\\
x_0 \in X \text{ -- дадено}
\end{array} 
\end{equation}

\begin{itemize}
	\item $ x_t \in X $, където $ X \subset \mathbb{R}^n $ е множеството от допустими стойности
	\item $ \beta \in (0,1) $ -- дисконтов фактор (множител)
	\item $ \Gamma (x) \subset X $ -- множество от допустими стойности за следващия период за дадено $ x $
	\item Обичайно за $ F $ и $ \Gamma $ се правят подходящи допускания
\end{itemize}
\end{frame}


\begin{frame}[fragile]
	\frametitle{Пример}
	\framesubtitle{Модел на икономически растеж за едносекторна икономика}
\begin{itemize}\itemsep1em
	\item $ f(k_t) $ -- производствена функция, където с $ k_t $ е означен физическият капитал 
	\item Уравнение за натрупване на капитала:
	\[ k_{t+1} = (1-\delta)k_t + i_t, \]
	където $ \delta \in (0,1) $ е нормата на амортизация, $ i_t $ са инвестициите, а $ k_0 > 0$ е даден
	\item БВП тъждество:
	\[ y_t = c_t + i_t, \]
	$ c_t $ -- потребление
\end{itemize}
\end{frame}


\begin{frame}[fragile]
	\frametitle{Пример}
	\framesubtitle{Модел на икономически растеж за едносекторна икономика}
	\begin{itemize}\itemsep1em
		\item $ U(c_t) $ -- функция на полезност
		\item Целеви функционал:
		\begin{equation}\label{eq:U}
		\sum_{t=0}^{\infty}\beta^t U(c_t)
		\end{equation}
		\item Еквивалентен запис на уравнението за натрупване на капитала:
		\begin{equation}\label{eq:K}
		 k_{t+1} = (1-\delta)k_t + f(k_t) - c(t),\quad k_0>0
		\end{equation}
		\item Ограничения $ k_t, c_t \geq 0 $, откъдето 
		\begin{equation}\label{eq:C}
		c_t \in [0,(1-\delta)k_t + f(k_t)]
		\end{equation}
	\end{itemize}
\end{frame}


\begin{frame}[fragile]
	\frametitle{Пример}
	\framesubtitle{Модел на икономически растеж за едносекторна икономика}
	\begin{itemize}
		\item Задачата е да се максимизира \eqref{eq:U} по $ \{c_t\}_{t=0}^\infty $ при ограничения \eqref{eq:K} и \eqref{eq:C}
		\item Можем да се освободим от $ c_t $ и да запишем задачата в еквивалентен вид като
		\[ \max_{ \{k_{t+1}\}_{t=0}^{\infty} } \sum_{t=0}^{\infty}\beta^t U((1-\delta)k_t + f(k_t) - k_{t+1}) \]
		s.t. \[ k_{t+1} \in [0, (1-\delta)k_t + f(k_t)] \] при дадено $ k_0>0 $
		\item При този запис имаме $ F(x_t,x_{t+1}) :=  U((1-\delta)k_t + f(k_t) - k_{t+1})$ и $ \Gamma (x) := [0, (1-\delta)k_t + f(k_t)] $	
	\end{itemize}
\end{frame}


\begin{frame}[fragile]
	\frametitle{Основни допускания}
	\framesubtitle{}
	Нека означим с 
	\[ \Pi (x_0) = \{ \{x_t\}_{t=0}^\infty \vert x_{t+1} \in \Gamma(x_t),~ t\geq 0 \} \] множеството на всички допустими траектории (планове), започващи от $ x_0 $.\medskip
	
	За да бъде добре дефинирана задачата \eqref{eq:SP} е необходимо да се направят определени допускания:
	\begin{itemize}\itemsep1em
		\item[Д1] $ \Gamma(x) \neq \emptyset,~\forall x \in X $
		\item[Д2] $ \exists \lim_{n\rightarrow \infty}\sum_{t=0}^{n}\beta^t F(x_t,x_{t+1}),~~\forall x_0 \in X,~ \underline{x}\in \Pi (x_0) $
	\end{itemize}\medskip

\textbf{Забележка:}	Изобщо съществуването на границата в Д2 не изключва случая, когато тя е  $ \pm \infty $. Поради това
общата постановка на \eqref{eq:SP} е със $ \sup $ вместо $ \max $. 
\end{frame}


\begin{frame}[fragile]
\frametitle{Дефиниция на функция-цена}
\framesubtitle{}
\begin{itemize}\itemsep1em
	\item Нека дефинираме $ u_n:\Pi(x_0)\rightarrow \mathbb{R} $ като 
	\[ u_n(\underline{x}) = \sum_{t=0}^{n}\beta^t F(x_t,x_{t+1}) \]
	и
	\[ u(\underline{x}) = \lim\limits_{n\rightarrow \infty} u_n(\underline{x}) \]
	\item Ако допускания Д1 и Д2 са в сила, можем да дефинираме функцията $ v^* $ като
	\[ v^*(x_0) = \sup_{\underline{x}\in \Pi (x_0)}u(\underline{x}) \]
	\item Тази функция се нарича \emph{функция-цена}
\end{itemize}
\textbf{Забележка:} Английският термин е \emph{value function}, но по-популярният термин на български е ,,функция-цена''.
\end{frame}

\begin{frame}[fragile]
\frametitle{Уравнение на Белман}
\framesubtitle{}
\begin{itemize}\itemsep1em
	\item Разглеждаме следното уравнение:
	\begin{equation}\label{eq:FE}\tag{FE}
	v(x) = \sup_{y \in \Gamma (x)}[F(x,y) + \beta v(y)],~\forall x \in X
	\end{equation}
	\item Уравнението \eqref{eq:FE} е функционално: функцията $ v(\cdot) $ е неизвестна
	\item Уравнението \eqref{eq:FE} се нарича \emph{уравнение на Белман}
	\item Уравнението на Белман представлява интерес, защото решенията му са свързани с решенията на задачата \eqref{eq:SP}
\end{itemize}
\end{frame}

\begin{frame}[fragile]
\frametitle{Уравнение на Белман}
\framesubtitle{Принцип за оптималност}
\begin{itemize}\itemsep1em
	\item Общата идея е, че решение $ v $ на \eqref{eq:FE}, оценено в точката $ x_0 $, дава точно супремума на целевия функционал в \eqref{eq:SP}
	\item Очакваме също така, че за една редица $ \{x_{t+1}\}_{t=0}^\infty $ супремумът за \eqref{eq:SP} се достига точно тогава, когато редицата удовлетворява 
	\begin{equation}\label{eq:OptSeq}
	v(x_t) = F(x_t,x_{t+1}) + \beta v(x_{t+1}), \quad t=0,1,2,\ldots
	\end{equation}
	\item Тези идеи (които засега са хипотези) са известни като \emph{принцип за оптималност (на Белман)}
\end{itemize}
\end{frame}


\begin{frame}[fragile]
\frametitle{Уравнение на Белман}
\framesubtitle{}
\begin{itemize}\itemsep1em
\item Ако функцията-цена удовлетворява уравнението на Белман (както се надяваме), то тя по същество участва в рекурсивна връзка:
\begin{itemize}\itemsep1em
\item Функцията-цена в точка $ x $ може да се получи чрез решаването на максимизационна задача за избор на следваща точка $ y $ при критерий сумата от текущата стойност на целевата функция ($ F $) и дисконтираната ,,остатъчна'' стойност на целевия функционал за точката $ y $
\end{itemize} 
\item Ако знаехме функцията-цена, бихме могли да използваме \eqref{eq:FE}, за да итерираме по оптималната траектория. Това е идеята на уравнение \eqref{eq:OptSeq}.
\item Така с помощта на уравнението на Белман задачата за намиране на цялата оптимална редица за \eqref{eq:SP} може да се сведе до серия от оптимизационни задачи за намиране на отделните елементи на тази редица
\end{itemize}
\end{frame}




\begin{frame}[fragile]
\frametitle{Основни резултати за връзките между \eqref{eq:SP} и \eqref{eq:FE} }
\framesubtitle{}

Следващият резултат показва, че функцията-цена е решение на уравнението на Белман:

\begin{thm}[SL, Th. 4.2]
Нека $ X,~\Gamma,~F $ и $ \beta $ удовлетворяват допускания Д1 и Д2. Тогава функцията $ v^* $ е решение на \eqref{eq:FE}.
\end{thm}\pause

\begin{itemize}\itemsep1em
\item Функцията-цена не е непременно единственото решение на уравнението на Белман
\item Това подсказва, че е необходимо да се търсят допълнителни критерии за изолиране на функцията-цена от множеството на решенията на \eqref{eq:FE}
\end{itemize}
\end{frame}

\begin{frame}[fragile]
\frametitle{Основни резултати за връзките между \eqref{eq:SP} и \eqref{eq:FE} }
\framesubtitle{}

Оказва се, че ако едно решение на уравнението на Белман в допълнение удовлетворява специално условие за ограниченост, то това решение е именно функцията-цена:

\begin{thm}[SL, Th. 4.3]
Нека $ X,~\Gamma,~F $ и $ \beta $ удовлетворяват допускания Д1 и Д2. Ако функцията $ v $ е решение на \eqref{eq:FE} и удовлетворява условието
\begin{equation}\label{eq:TransCond_1}
\lim_{n\rightarrow \infty} \beta^n v(x_n) = 0, \quad \forall (x_0,x_1,\ldots) \in \Pi(x_0),~\forall x_0 \in X,
\end{equation}
то $ v=v^* $.
\end{thm}\pause

\begin{itemize}\itemsep1em
\item Условието \eqref{eq:TransCond_1} трябва да бъде изпълнено за произволна допустима редица
\item \textbf{Интерпретация:} за всяка допустима редица дисконтираната остатъчна стойност трябва да се анулира в граница 
\end{itemize}
\end{frame}


\begin{frame}[fragile]
\frametitle{Основни резултати за връзките между \eqref{eq:SP} и \eqref{eq:FE} }
\framesubtitle{}
Установените дотук резултати характеризират оптималната стойност на целевия функционал, но не казват как да конструираме допустим план, с който да постигнем тази оптимална стойност (т.е. оптимален план). Следващият резултат показва, че оптималният план е решение на \eqref{eq:OptSeq} при $ v=v^* $:

\begin{thm}[SL, Th. 4.4]
Нека $ X,~\Gamma,~F $ и $ \beta $ удовлетворяват допускания Д1 и Д2. Нека $ \underline{x}^* \in \Pi (x_0) $ е допустим план, за който се достига супремумът в \eqref{eq:SP} за начално условие $ x_0 $. Тогава имаме
	\begin{equation}\label{eq:OptSeqAgain}
	v^*(x^*_t) = F(x^*_t,x^*_{t+1}) + \beta v^*(x^*_{t+1}),\quad t=0,1,2,\ldots
	\end{equation}
\end{thm}
\end{frame}


\begin{frame}[fragile]
\frametitle{Основни резултати за връзките между \eqref{eq:SP} и \eqref{eq:FE} }
\framesubtitle{}
Аналогично на това, че не всяко решение на \eqref{eq:FE} ни дава функцията-цена, може да има редици, които удовлетворяват \eqref{eq:OptSeqAgain}, без да са оптимални. За да намерим оптимална редица, отново ни трябва допълнително условие за ограниченост:

\begin{thm}[SL, Th. 4.5]
Нека $ X,~\Gamma,~F $ и $ \beta $ удовлетворяват допускания Д1 и Д2. Нека $ \underline{x}^* \in \Pi (x_0) $ е допустим план, който удовлетворява \eqref{eq:OptSeqAgain} и нека в допълнение е в сила
\begin{equation}\label{eq:TransCond_2}
\limsup_{t\rightarrow \infty}\beta^t v^*(x^*_t) \leq 0.
\end{equation}
Тогава за $ \underline{x}^* $ се достига супремумът в \eqref{eq:SP}.
\end{thm}
\end{frame}



\begin{frame}[fragile]\setcounter{slidenum}{1}
\frametitle{Уравнения на Ойлер (\arabic{slidenum})}
\framesubtitle{Постановка на задачата}
Разглеждаме познатата задача
\begin{equation}\tag{SP}
\begin{array}{l}
\sup_{ \{x_{t+1}\}_{t=0}^\infty }
\sum_{t=0}^{\infty}\beta^t F(x_t,x_{t+1}) \\ 
{}\\
\text{s.t. } x_{t+1}\in \Gamma (x_t),~t=0,1,2,\ldots, \\ {}\\
x_0 \in X \text{ -- дадено}
\end{array} 
\end{equation}\medskip

За нея правим технически допускания (вж. 4.3-4.5, 4.7 и 4.9 в SL за пълния списък) като:
\begin{itemize}
\item Множеството $ X $ е изпъкнало подмножество на $ \mathbb{R}^l $ и $ \Gamma(x) $ е непразно и компактно за всяко $ x $
\item Функцията $ F $ е ограничена, непрекъснато диференцируема във вътрешността на допустимото множество, строго вдлъбната и $ F(\cdot,y) $ е нарастваща по първите $ l $ аргумента за всяко $ y $
\end{itemize}
\end{frame}

\begin{frame}[fragile]\stepcounter{slidenum}
\frametitle{Уравнения на Ойлер (\arabic{slidenum})}
\framesubtitle{Интуиция за извеждане на НУ за оптималност}
\begin{itemize}\itemsep1em
\item Нека, за дадено $ x_0 $, имаме редица $ \{x^*_{t+1}\}_{t=0}^\infty $, която е решение на \eqref{eq:SP}.
\item Тогава за всяко $ t $ тази редица трябва да бъде решение и на задачата 
\begin{equation}\label{eq:SL1}
\begin{array}{l}
\max_{y}[F(x^*_t,y)+\beta F(y,x_{t+2}^*)] \\ {} \\ 
\text{s.t. } y\in \Gamma (x_t^*),\qquad x_{t+2}^* \in \Gamma(y)
\end{array} 
\end{equation}
\item \textbf{Интуиция}: редицата $ \{x^*_{t+1}\}_{t=0}^\infty $ не може да е оптимална, ако е възможно да направим допустима вариация на някой елемент и това да доведе до нарастване на целевия функционал.
\end{itemize}
\end{frame}

\begin{frame}[fragile]\stepcounter{slidenum}
\frametitle{Уравнения на Ойлер (\arabic{slidenum})}
\framesubtitle{Формулировка на НУ за оптималност}
\begin{itemize}\itemsep1em
\item Нека $ F_x $ и $ F_y $ означават $ l $-мерните вектори от частни производни съответно по първите и по вторите $ l $ аргумента
\item Ако $ x^*_{t+1} $ е във вътрешността на $ \Gamma(x^*_t) $ за всяко $ t $, тогава условията за решение на задача \eqref{eq:SL1} са
\begin{equation}\label{eq:SL2}
0=F_y(x^*_t,x^*_{t+1}) + \beta F_x(x^*_{t+1},x^*_{t+2}),~~t=0,1,2,\ldots
\end{equation}
\item Условията \eqref{eq:SL2} задават система от $ l $ на брой диференчни уравнения от втори ред.
\end{itemize}
\end{frame}

\begin{frame}[fragile]\stepcounter{slidenum}
\frametitle{Уравнения на Ойлер (\arabic{slidenum})}
\framesubtitle{Допълнителни условия за намиране на оптимално решение}
\begin{itemize}\itemsep1em
\item  Щом \eqref{eq:SL2} са система от $ l $ диференчни уравнения от втори ред, тогава ни трябват $ 2l $ условия, за да намерим решение
\item Векторът от начални условия $ x_0 $ задава $ l $ такива условия
\item Още $ l $ условия се задават от т.нар. условия за трансверсалност:
\begin{equation}\label{eq:SL3}
\lim_{t\rightarrow \infty} \beta^t F_x(x^*_t,x^*_{t+1})\cdot x_t^* = 0.
\end{equation}
\item Интерпретация за условието за трансверсалност
\end{itemize}
\end{frame}

\begin{frame}[fragile]\stepcounter{slidenum}
\frametitle{Уравнения на Ойлер (\arabic{slidenum})}
\framesubtitle{Достатъчни условия за оптималност}
\begin{thm}[SL, Теорема 4.15]
Нека $ X \subset \mathbb{R}_+^l $ и $ F $ удовлетворява допускания 4.3--4.5, 4.7 и 4.9. Тогава редицата $ \{x^*_{t+1}\}_{t=0}^\infty $, за която $ x^*_{t+1} \in \Gamma (x^*_t) $, $ t=0,1,\ldots $, е решение на задачата \eqref{eq:SP} за зададено $ x_0 $, ако тя удовлетворява условията \eqref{eq:SL2} и \eqref{eq:SL3}.
\end{thm}
\end{frame}

\begin{frame}\setcounter{slidenum}{1}
	\frametitle{Пример: Извеждане на НУ за задача във вариационна формулировка (\arabic{slidenum})}
	Задача:
	\[ \max_{\{c_t\}} \sum_{t=0}^{\infty}\beta^t \ln c_t  \]
	\[ k_{t+1} = (1-\delta)k_t + y_t - c_t,\quad k_0>0 \text{ -- дадено} \] \[ y_t=A k_t^\alpha , \quad 0<\underline{\epsilon} \leq c_t \leq \overline{\epsilon}, \quad \alpha,\beta \in (0,1), \quad A>0\]
	
	НУ: 
	\[ \sum_{t=0}^{\infty}\beta^t \underbrace{\ln ((1-\delta)k_t + A k_t^\alpha - k_{t+1})}_{= F(x_t,x_{t+1})}. \]
	
	{\color{red}Уравнение на Ойлер: \[ F_y(x_t,x_{t+1})+\beta F_x(x_{t+1},x_{t+2})=0 \]}
\end{frame}



\begin{frame}\stepcounter{slidenum}
	\frametitle{Пример: Извеждане на НУ за задача във вариационна формулировка (\arabic{slidenum})}
	При прилагане на уравнението на Ойлер:
	\[ \frac{-1}{(1-\delta)k_t +A k_t^\alpha -k_{t+1}} + \beta \frac{(1-\delta) + \alpha A k_{t+1}^{\alpha -1}}{(1-\delta)k_{t+1} +A k_{t+1}^\alpha -k_{t+2}} = 0 \]
	
	Последното има вида 
	\[ G(x_{t+2},x_{t+1},x_t)=0, \]
	т.е. нелинейно диференчно уравнение от II ред.

\end{frame}

\end{document}


